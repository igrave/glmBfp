<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Produce posterior samples from one GLM / Cox model — sampleGlm • glmBfp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Produce posterior samples from one GLM / Cox model — sampleGlm"><meta name="description" content="Based on the result list from glmBayesMfp, for the first model
in the list MCMC samples are produced. In parallel to the sampling of
coefficients and FP curve points, optionally the marginal likelihood of the
model is estimated with MCMC samples. This provides a check of the
integrated Laplace approximation used in the model sampling. If TBF
methodology is used, then no MCMC is necessary, instead ordinary Monte Carlo
samples from an approximate posterior distribution are obtained."><meta property="og:description" content="Based on the result list from glmBayesMfp, for the first model
in the list MCMC samples are produced. In parallel to the sampling of
coefficients and FP curve points, optionally the marginal likelihood of the
model is estimated with MCMC samples. This provides a check of the
integrated Laplace approximation used in the model sampling. If TBF
methodology is used, then no MCMC is necessary, instead ordinary Monte Carlo
samples from an approximate posterior distribution are obtained."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmBfp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0-61</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Cox.html">Using `glmBfp`: Cox models with test-based Bayes Factors</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Using `glmBfp`: a binary regression example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Produce posterior samples from one GLM / Cox model</h1>

      <div class="d-none name"><code>sampleGlm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Based on the result list from <code><a href="glmBayesMfp.html">glmBayesMfp</a></code>, for the first model
in the list MCMC samples are produced. In parallel to the sampling of
coefficients and FP curve points, optionally the marginal likelihood of the
model is estimated with MCMC samples. This provides a check of the
integrated Laplace approximation used in the model sampling. If TBF
methodology is used, then no MCMC is necessary, instead ordinary Monte Carlo
samples from an approximate posterior distribution are obtained.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sampleGlm</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  mcmc <span class="op">=</span> <span class="fu"><a href="McmcOptions.html">McmcOptions</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  estimateMargLik <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gridList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  gridSize <span class="op">=</span> <span class="fl">203L</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixedZ <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  marginalZApprox <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useOpenMP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  correctedCenter <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>the <code>GlmBayesMfp</code> object, from which only the first model
will be processed (at least for now ...)</p></dd>


<dt id="arg-mcmc">mcmc<a class="anchor" aria-label="anchor" href="#arg-mcmc"></a></dt>
<dd><p>MCMC options object with class <code><a href="McmcOptions-class.html">McmcOptions</a></code>.
If TBF is used, each sample is accepted, and the number of samples is given
by <code><a href="sampleSize.html">sampleSize</a></code>(<code>mcmc</code>).</p></dd>


<dt id="arg-estimatemarglik">estimateMargLik<a class="anchor" aria-label="anchor" href="#arg-estimatemarglik"></a></dt>
<dd><p>shall the marginal likelihood be estimated in
parallel? (default) Only has an effect if full Bayes and not TBF is used.</p></dd>


<dt id="arg-gridlist">gridList<a class="anchor" aria-label="anchor" href="#arg-gridlist"></a></dt>
<dd><p>optional list of appropriately named grid vectors for FP
evaluation. Default is length (<code>gridSize</code> - 2) grid per covariate
additional to the observed values (two are at the endpoints)</p></dd>


<dt id="arg-gridsize">gridSize<a class="anchor" aria-label="anchor" href="#arg-gridsize"></a></dt>
<dd><p>see above (default: 203)</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>new covariate data.frame with exactly the names (and
preferably ranges) as before (default: no new covariate data) Note that
there is no option for offsets for new data at the moment. Just add the
offsets to the <code>predictions</code> slot of <code>samples</code> in the return list
yourself.</p></dd>


<dt id="arg-fixedz">fixedZ<a class="anchor" aria-label="anchor" href="#arg-fixedz"></a></dt>
<dd><p>either <code>NULL</code> (default) or a (single) fixed z value to
be used, in order to sample from the conditional posterior given this z.
If <code>object</code> was constructed by the empirical Bayes machinery,
this will default to the estimated z with maximum conditional marginal
likelihood. If <code>object</code> was constructed with the option <code>fixedg</code>,
then the fixed value will be used by default.</p></dd>


<dt id="arg-marginalzapprox">marginalZApprox<a class="anchor" aria-label="anchor" href="#arg-marginalzapprox"></a></dt>
<dd><p>method for approximating the marginal density of the
log covariance factor z, see <code><a href="getMarginalZ.html">getMarginalZ</a></code> for the details
(default: same preference list as in <code><a href="getMarginalZ.html">getMarginalZ</a></code>)
If TBF are used in conjunction with incomplete inverse gamma hyperprior on
g = exp(z), then the posterior distribution of g is again of this form.
Therefore this option does not have any effect in that case, because the
samples are directly obtained from that posterior distribution.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>should information on computation progress be given?
(default)</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>print debugging information? (not default)</p></dd>


<dt id="arg-useopenmp">useOpenMP<a class="anchor" aria-label="anchor" href="#arg-useopenmp"></a></dt>
<dd><p>shall OpenMP be used to accelerate the computations?
(default)</p></dd>


<dt id="arg-correctedcenter">correctedCenter<a class="anchor" aria-label="anchor" href="#arg-correctedcenter"></a></dt>
<dd><p>If TRUE predict new data based on the centering
of the original data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list with the following elements:</p><dl><dt>samples</dt>
<dd><p>an object of S4 class
<code><a href="GlmBayesMfpSamples-class.html">GlmBayesMfpSamples</a></code></p></dd>

<dt>coefficients</dt>
<dd><p>samples of all original coefficients in the model
(nCoefs x nSamples)</p></dd>

<dt>acceptanceRatio</dt>
<dd><p>proportion of accepted Metropolis-Hastings proposals</p></dd>

<dt>logMargLik</dt>
<dd><p>if <code>estimateMargLik</code> is <code>TRUE</code>, this list is
included: it contains the elements <code>numeratorTerms</code> and
<code>denominatorTerms</code> for the numerator and denominator samples of the
Chib Jeliazkov marginal likelihood estimate,
<code>highDensityPointLogUnPosterior</code> is the log unnormalized posterior
density at the fixed parameter and the resulting <code>estimate</code> and
<code>standardError</code>.</p></dd>


</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Gravestock, Daniel Sabanes Bove.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

