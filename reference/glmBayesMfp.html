<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian model inference for fractional polynomial GLMs and Cox models — glmBayesMfp • glmBfp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian model inference for fractional polynomial GLMs and Cox models — glmBayesMfp"><meta name="description" content="Bayesian model inference for fractional polynomial models from the generalized linear model
family or the Cox model is conducted by means of either exhaustive model space evaluation or posterior model
sampling. The approach is based on analytical marginal likelihood approximations, using
integrated Laplace approximation. Alternatively, test-based Bayes factors
(TBFs) are used."><meta property="og:description" content="Bayesian model inference for fractional polynomial models from the generalized linear model
family or the Cox model is conducted by means of either exhaustive model space evaluation or posterior model
sampling. The approach is based on analytical marginal likelihood approximations, using
integrated Laplace approximation. Alternatively, test-based Bayes factors
(TBFs) are used."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glmBfp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0-61</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Cox.html">Using `glmBfp`: Cox models with test-based Bayes Factors</a></li>
    <li><a class="dropdown-item" href="../articles/examples.html">Using `glmBfp`: a binary regression example</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian model inference for fractional polynomial GLMs and Cox models</h1>

      <div class="d-none name"><code>glmBayesMfp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bayesian model inference for fractional polynomial models from the generalized linear model
family or the Cox model is conducted by means of either exhaustive model space evaluation or posterior model
sampling. The approach is based on analytical marginal likelihood approximations, using
integrated Laplace approximation. Alternatively, test-based Bayes factors
(TBFs) are used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmBayesMfp</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  censInd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sys.parent.html" class="external-link">parent.frame</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  <span class="va">offset</span>,</span>
<span>  <span class="va">family</span>,</span>
<span>  phi <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tbf <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  empiricalBayes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fixedg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  priorSpecs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gPrior <span class="op">=</span> <span class="fu"><a href="HypergPrior.html">HypergPrior</a></span><span class="op">(</span><span class="op">)</span>, modelPrior <span class="op">=</span> <span class="st">"sparse"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ask"</span>, <span class="st">"exhaustive"</span>, <span class="st">"sampling"</span><span class="op">)</span>,</span>
<span>  <span class="va">subset</span>,</span>
<span>  na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">nModels</span>,</span>
<span>  nCache <span class="op">=</span> <span class="fl">1e+09</span>,</span>
<span>  chainlength <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  nGaussHermite <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  useBfgs <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  largeVariance <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  useOpenMP <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  higherOrderCorrection <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fixedcfactor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  empiricalgPrior <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  centerX <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>model formula</p></dd>


<dt id="arg-censind">censInd<a class="anchor" aria-label="anchor" href="#arg-censind"></a></dt>
<dd><p>censoring indicator. Default is <code>NULL</code>, but if
a non-<code>NULL</code> vector is supplied, this is assumed to be logical
(<code>TRUE</code> = observed, <code>FALSE</code> = censored) and Cox regression is
performed.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>optional data.frame for model variables (defaults to the parent
frame)</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>optionally a vector of positive weights (if not provided, a
vector of one's)</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting. This must be a numeric
vector of length equal to the number of cases (if not provided, a vector of
zeroes)</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>distribution and link (as in the glm function). Needs to
be explicitly specified for all models except the Cox model.</p></dd>


<dt id="arg-phi">phi<a class="anchor" aria-label="anchor" href="#arg-phi"></a></dt>
<dd><p>value of the dispersion parameter (defaults to 1)</p></dd>


<dt id="arg-tbf">tbf<a class="anchor" aria-label="anchor" href="#arg-tbf"></a></dt>
<dd><p>Use TBF methodology to compute the marginal likelihood? (not
default) Must be <code>TRUE</code> if Cox regression is done.</p></dd>


<dt id="arg-empiricalbayes">empiricalBayes<a class="anchor" aria-label="anchor" href="#arg-empiricalbayes"></a></dt>
<dd><p>rank the models in terms of <em>conditional</em>
marginal likelihood, using an empirical Bayes estimate of g? (not default)
Due to coding structure, the prior on g must be given in <code>priorSpecs</code>
although it does not have an effect when <code>empiricalBayes==TRUE</code>.</p></dd>


<dt id="arg-fixedg">fixedg<a class="anchor" aria-label="anchor" href="#arg-fixedg"></a></dt>
<dd><p>If this is a number, then it is taken as a fixed value of g,
and as with the <code>empiricalBayes</code> option, the models are ranked in terms
of conditional marginal likelihood. By default, this option is <code>NULL</code>,
which means that g is estimated in a fully or empirical Bayesian way.</p></dd>


<dt id="arg-priorspecs">priorSpecs<a class="anchor" aria-label="anchor" href="#arg-priorspecs"></a></dt>
<dd><p>prior specifications, see details</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>which method should be used to explore the  posterior model
space? (default: ask the user)</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>optional subset expression</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>default is to skip rows with missing data, and no other
option supported at the moment</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>should information on computation progress be given?
(default)</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>print debugging information? (not default)</p></dd>


<dt id="arg-nmodels">nModels<a class="anchor" aria-label="anchor" href="#arg-nmodels"></a></dt>
<dd><p>how many best models should be saved? (default: 1% of the
total number of (cached) models). Must not be larger than <code>nCache</code> if
<code>method == "sampling"</code>.</p></dd>


<dt id="arg-ncache">nCache<a class="anchor" aria-label="anchor" href="#arg-ncache"></a></dt>
<dd><p>maximum number of best models to be cached at the same time
during the model sampling, only has effect if method = sampling</p></dd>


<dt id="arg-chainlength">chainlength<a class="anchor" aria-label="anchor" href="#arg-chainlength"></a></dt>
<dd><p>length of the model sampling chain (only has an effect if
sampling has been chosen as method)</p></dd>


<dt id="arg-ngausshermite">nGaussHermite<a class="anchor" aria-label="anchor" href="#arg-ngausshermite"></a></dt>
<dd><p>number of quantiles used in Gauss Hermite quadrature
for marginal likelihood approximation (and later in the MCMC sampler for the
approximation of the marginal covariance factor density). If
<code>empiricalBayes</code> or a fixed g is used, this option has no effect.</p></dd>


<dt id="arg-usebfgs">useBfgs<a class="anchor" aria-label="anchor" href="#arg-usebfgs"></a></dt>
<dd><p>Shall the BFGS algorithm be used in the internal maximization
(not default)? Else, the default Brent optimize routine is used, which seems
to be more robust. If <code>empiricalBayes</code> or a fixed g is used, this
option has no effect and always the Brent optimize routine is used.</p></dd>


<dt id="arg-largevariance">largeVariance<a class="anchor" aria-label="anchor" href="#arg-largevariance"></a></dt>
<dd><p>When should the BFGS variance estimate be considered
“large”, so that a reestimation of it is computed? (Only has an
effect if <code>useBfgs == TRUE</code>, default: 100)</p></dd>


<dt id="arg-useopenmp">useOpenMP<a class="anchor" aria-label="anchor" href="#arg-useopenmp"></a></dt>
<dd><p>shall OpenMP be used to accelerate the computations?
(default)</p></dd>


<dt id="arg-higherordercorrection">higherOrderCorrection<a class="anchor" aria-label="anchor" href="#arg-higherordercorrection"></a></dt>
<dd><p>should a higher-order correction of the
Laplace approximation be used, which works only for canonical GLMs? (not
default)</p></dd>


<dt id="arg-fixedcfactor">fixedcfactor<a class="anchor" aria-label="anchor" href="#arg-fixedcfactor"></a></dt>
<dd><p>If TRUE sets the c factor assuming alpha is set to 0. Otherwise take alpha=mean(y)</p></dd>


<dt id="arg-empiricalgprior">empiricalgPrior<a class="anchor" aria-label="anchor" href="#arg-empiricalgprior"></a></dt>
<dd><p>If TRUE uses the the observed isnformation matrix instead of X'X in the g prior. (Experimental)</p></dd>


<dt id="arg-centerx">centerX<a class="anchor" aria-label="anchor" href="#arg-centerx"></a></dt>
<dd><p>Center the data before fitting (FALSE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of S3 class <code>GlmBayesMfp</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The formula is of the form <code>y ~ bfp (x1, max = 4) + uc (x2 + x3)</code>, that
is, the auxiliary functions <code><a href="formula.html">bfp</a></code> and <code><a href="formula.html">uc</a></code> must be
used for defining the fractional polynomial and uncertain fixed form
covariates terms, respectively. There must be an intercept, and no other
fixed covariates are allowed. All <code>max</code> arguments of the
<code><a href="formula.html">bfp</a></code> terms must be identical. <code>y</code> is the response vector
for GLMs or the vector of survival times for Cox regression. Note that Cox
regression is only implemented with TBFs.</p>
<p>The prior specifications are a list:</p><dl><dt>gPrior</dt>
<dd><p>A g-prior class object. Defaults to a hyper-g prior. See
  <code><a href="GPrior-class.html">GPrior</a></code> for more information.</p></dd>

  <dt>modelPrior</dt>
<dd><p>choose if a flat model prior (<code>"flat"</code>), a
  model prior favoring sparse models explicitly (default, <code>"sparse"</code>),
  or a dependent model prior (<code>"dependent"</code>) should be used.</p></dd>


</dl><p>If <code>method = "ask"</code>, the user is prompted with the maximum
cardinality of the model space and can then decide whether to use
posterior sampling or the exhaustive model space evaluation.</p>
<p>Note that if you specify only one FP term, the exhaustive model search
must be done, due to the structure of the model sampling algorithm.
However, in reality this will not be a problem as the model space will
typically be very small.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Gravestock, Daniel Sabanes Bove.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

